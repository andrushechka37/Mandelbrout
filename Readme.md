## МОСКОВСКИЙ ФИЗИКО-ТЕХНИЧЕСКИЙ ИНСТИТУТ (НАЦИОНАЛЬНЫЙ ИССЛЕДОВАТЕЛЬСКИЙ УНИВЕРСИТЕТ)

## Физтех-школа Радиотехники и Компьютерных технологий
<br/>


# ![1](/images/2.png) 

##  Отчёт о выполнении лабораторной работы 2.2.1
#  SIMD-оптимизация расчета множества Мандельброта
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>

## Автор: Житников Андрей Павлович, Б01-303
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>

## Долгопрудный
## 23 марта, 2024
<br/>
<br/>
<br/>
<br/>
<br/>

# `1 Введение`: 
## *Цель работы* : исследовать эффективность SIMD оптимизаций
## *В работе используется* : `MAC` на процессоре `M2`*
#### *для доступа к серверу
# `2 Теоретические сведения`: 
## читайте бх 3,4,5 главу
# `3 Экспериментальная установка`:
## Удаленный сервер
![1](/images/1.png)
# `4 Ход работы`:

<br/>
<br/>
<br/>

# Первый опыт: manda1.cpp
<br/>
<br/>

## Простейший вариант программы, использующий:
* inline функции
* вынос кода

# Второй опыт: manda2.cpp
## Слегла усовершенствованный вариант manda1.cpp
* развертывание цикла 4x
  
# Третий опыт: manda3.cpp
## Это manda2.cpp но оптимизировано с помощю SIMD
* SIMD оптимизации




# `3 Обсуждение результатов и выводы`:
# Способ измерения времени:
## Была использована функция `__rdtsc`, которая возвращает количество циклов часов процессора с момента последнего сброса. В переменную start записывается начальное значение, в переменную end конечное, время на прорисовку изображения не учитывается, разность суммируется и высчитывается среднее

## Также были проведены измерения при помощи встроенного clock в sfml

## Была использована volatile переменная, чтобы оптимизатор не выкидывал нужные участки программы

|     version    |    name    | Compilation flags |   ticks   | Speed Growth calculated with rdtsc | FPS   | Speed Growth calculated with clock |
|:--------------:|:----------:|:-----------------:|:---------:|:----------------------------------:|-------|:----------------------------------:|
|      base      | manda1.cpp |         -         | 539885080 |                  1                 | 4.18  |                  1                 |
|      base      | manda1.cpp |        -O3        | 239114461 |                2.25                | 9.69  |                2.31                |
| vectorized(4x) | manda2.cpp |         -         | 813460152 |                0.66                | 2.50  |                0.59                |
| vectorized(4x) | manda2.cpp |        -O3        |  83921589 |                6.43                | 19.97 |                4.77                |
| SIMD optimized | manda3.cpp |         -         | 359141844 |                1.50                | 6.67  |                1.59                |
| SIMD optimized | manda3.cpp |        -O3        |  70109264 |                7.71                | 29.29 |                  7                 |

## Оптимизации комплиллятора -O3 очень сильно повышают производительность независимо от кода (в 2 - 7 раз). Развертывание цикла 4x лишь замедлило выполнение программы, тк для оптимизиатора было сложно уловить пути оптимизации, но при компиллировании с O3 скорость выполнения значительно возрасла (в ~ 10 раз). SIMD оптимизации дали значительный прирост производительности (7.5 раз).
## Некоторые показания clock и rdtsc расходятся, поэтому лучше использовать rdtsc, тк он считает с большей точностью.

