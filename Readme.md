## МОСКОВСКИЙ ФИЗИКО-ТЕХНИЧЕСКИЙ ИНСТИТУТ (НАЦИОНАЛЬНЫЙ ИССЛЕДОВАТЕЛЬСКИЙ УНИВЕРСИТЕТ)

## Физтех-школа Радиотехники и Компьютерных технологий
<br/>


# ![1](/images/2.png) 

##  Отчёт о выполнении лабораторной работы 2.2.1
#  SIMD-оптимизация расчета множества Мандельброта
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>

## Автор: Житников Андрей Павлович, Б01-303
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>

## Долгопрудный
## 23 марта, 2024
<br/>
<br/>
<br/>
<br/>
<br/>

# `1 Введение`: 

## Для нагрузки процессора был использован алгоритм  расчета множества Мандельброта, а для наглядности при помощи sfml было это визуализировано.

![3](/images/3.png)

# *Цель работы* : 
* Исследовать прирост эффективности от использования Intrinsic функций, сравнить результаты с наивной версией программы и с ее векторизованной версией с использованием равертывания цикла. 
* Сравнить производительность с -O3 и без него



## *В работе используется* : `MAC` на процессоре `M2`*
#### *для доступа к серверу
# `2 Теоретические сведения`: 
## RTFBX 3, 4, 5
# `3 Экспериментальная установка`:
## Удаленный сервер
![1](/images/1.png)
# `4 Ход работы`:

<br/>
<br/>
<br/>

# mand1.cpp
## Это самый первый и наивный вариант программы, от которого мы будем мерить прирост производительности.

# mand2.cpp
## Вторая версия, использующая разветрывание цикла 4x

# mand3.cpp
## Третья вермия программы, которая использует intrinsic функции

# Способ измерения времени:
## Была использована функция `__rdtsc`, которая возвращает количество циклов часов процессора с момента последнего сброса. Расчитывается разность этих возвращаемых значений и суммируется для вычисления среднего. Время на прорисовку изображения не учитывается, так как оно выключается при подсчете производительности.

## Были проведены измерения при помощи встроенного clock в sfml

## Была использована volatile переменная, чтобы оптимизатор не выкидывал нужные участки программы

|     version    |    name    | Compilation flags |   ticks   | Speed Growth calculated with rdtsc | FPS   | Speed Growth calculated with clock |
|:--------------:|:----------:|:-----------------:|:---------:|:----------------------------------:|-------|:----------------------------------:|
|      base      | manda1.cpp |         -         | 539885080 |                  1                 | 4.18  |                  1                 |
|      base      | manda1.cpp |        -O3        | 239114461 |                2.25                | 9.69  |                2.31                |
| vectorized(4x) | manda2.cpp |         -         | 813460152 |                0.66                | 2.50  |                0.59                |
| vectorized(4x) | manda2.cpp |        -O3        |  83921589 |                6.43                | 19.97 |                4.77                |
| SIMD optimized | manda3.cpp |         -         | 359141844 |                1.50                | 6.67  |                1.59                |
| SIMD optimized | manda3.cpp |        -O3        |  70109264 |                7.71                | 29.29 |                  7                 |


# `5 Обсуждение результатов и выводы`:

## Оптимизации комплиллятора -O3 очень сильно повышают производительность независимо от кода (в 2 - 7 раз). Развертывание цикла 4x лишь замедлило выполнение программы, тк для компиллятора было сложно уловить пути оптимизации, но при компиллировании с O3 скорость выполнения значительно возрасла (в ~ 6 раз). Intrinsic функции дали значительный прирост производительности (в ~7.5 раз).

